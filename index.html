<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PriceMaster - Database Harga Barang</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <!-- React & Libraries -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        /* Styles for login page */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }
        
        .login-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(10px);
            animation: fadeIn 0.5s ease;
        }
        
        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .login-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .login-logo i {
            font-size: 36px;
            color: #4b6cb7;
        }
        
        .login-title {
            font-size: 32px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .login-subtitle {
            font-size: 16px;
            color: #7f8c8d;
            margin-bottom: 30px;
        }
        
        .login-form-group {
            margin-bottom: 20px;
        }
        
        .login-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .login-input {
            width: 100%;
            padding: 14px 20px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }
        
        .login-input:focus {
            outline: none;
            border-color: #4b6cb7;
            background: white;
            box-shadow: 0 0 0 3px rgba(75, 108, 183, 0.1);
        }
        
        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #4b6cb7, #3a5795);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(75, 108, 183, 0.3);
        }
        
        .login-btn:active {
            transform: translateY(0);
        }
        
        .login-error {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #e74c3c;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s ease;
        }
        
        .login-error.hidden {
            display: none;
        }
        
        .login-success {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #27ae60;
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.3s ease;
        }
        
        .login-success.hidden {
            display: none;
        }
        
        .login-loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }
        
        /* Main app styles */
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            backdrop-filter: blur(10px);
            animation: fadeIn 0.5s ease;
        }
        
        header {
            background: linear-gradient(135deg, #4b6cb7, #182848);
            color: white;
            padding: 20px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 8px;
        }
        
        .logo i {
            font-size: 28px;
            color: #4bcefa;
        }
        
        h1 {
            font-size: 30px;
            margin-bottom: 8px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        
        .description {
            font-size: 16px;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
            font-weight: 300;
        }
        
        .app-content {
            padding: 20px;
            display: flex;
            gap: 20px;
            transition: all 0.3s ease;
        }
        
        .sidebar {
            width: 220px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0,0,0,0.05);
            height: fit-content;
            transition: all 0.3s ease;
            position: relative;
            flex-shrink: 0;
        }
        
        .sidebar.minimized {
            width: 60px;
            padding: 20px 10px;
            overflow: hidden;
        }
        
        .sidebar.minimized .sidebar-content {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
        }
        
        .sidebar:not(.minimized) .sidebar-content {
            opacity: 1;
            pointer-events: all;
            transition: opacity 0.3s ease 0.1s;
        }
        
        .sidebar-toggle {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #4b6cb7, #3a5795);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            box-shadow: 0 3px 6px rgba(75, 108, 183, 0.3);
            transition: all 0.3s ease;
        }
        
        .sidebar-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 10px rgba(75, 108, 183, 0.4);
        }
        
        .sidebar.minimized .sidebar-toggle {
            position: relative;
            top: 0;
            right: 0;
            margin: 0 auto 20px;
        }
        
        .main-content {
            flex: 1;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }
        
        .sidebar.minimized + .main-content {
            margin-left: 0;
            flex: 1;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-bottom: 25px;
            border: 1px solid rgba(0,0,0,0.05);
        }
        
        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: #4b6cb7;
        }
        
        .btn {
            background: linear-gradient(135deg, #4b6cb7, #3a5795);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 6px rgba(75, 108, 183, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(75, 108, 183, 0.3);
        }
        
        .btn-sm {
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #27ae60, #219653);
            box-shadow: 0 4px 6px rgba(39, 174, 96, 0.2);
        }
        
        .btn-success:hover {
            box-shadow: 0 6px 12px rgba(39, 174, 96, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #7f8c8d, #6c7b7d);
            box-shadow: 0 4px 6px rgba(127, 140, 141, 0.2);
        }
        
        .btn-secondary:hover {
            box-shadow: 0 6px 12px rgba(127, 140, 141, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            box-shadow: 0 4px 6px rgba(243, 156, 18, 0.2);
        }
        
        .btn-warning:hover {
            box-shadow: 0 6px 12px rgba(243, 156, 18, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            box-shadow: 0 4px 6px rgba(231, 76, 60, 0.2);
        }
        
        .btn-danger:hover {
            box-shadow: 0 6px 12px rgba(231, 76, 60, 0.3);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid #4b6cb7;
            color: #4b6cb7;
            box-shadow: none;
        }
        
        .btn-outline:hover {
            background: #4b6cb7;
            color: white;
        }
        
        .controls-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .view-toggle {
            display: flex;
            gap: 10px;
            background: #f8f9fa;
            padding: 5px;
            border-radius: 10px;
        }
        
        .view-toggle button {
            flex: 1;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .view-toggle button.active {
            background: linear-gradient(135deg, #4b6cb7, #3a5795);
            color: white;
            box-shadow: 0 2px 5px rgba(75, 108, 183, 0.3);
        }
        
        .pagination-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .page-size-select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            background: white;
            font-weight: 500;
        }
        
        .pagination {
            display: flex;
            gap: 5px;
        }
        
        .pagination button {
            padding: 8px 12px;
            border-radius: 6px;
            background: white;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .pagination button:hover {
            background: #f8f9fa;
        }
        
        .pagination button.active {
            background: #4b6cb7;
            color: white;
            border-color: #4b6cb7;
        }
        
        .year-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 12px;
            align-items: center;
        }
        
        .year-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            padding: 8px 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #ddd;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .year-checkbox:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .year-checkbox input {
            width: auto;
            margin: 0;
        }
        
        .year-checkbox.checked {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-color: #4b6cb7;
            color: #2c3e50;
            font-weight: 600;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        
        th, td {
            padding: 15px 20px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background: linear-gradient(135deg, #4b6cb7, #3a5795);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        tr:hover {
            background-color: #f8f9fa;
        }
        
        .price-increase {
            color: #27ae60;
            font-weight: 700;
        }
        
        .price-decrease {
            color: #e74c3c;
            font-weight: 700;
        }
        
        .no-change {
            color: #7f8c8d;
        }
        
        .actions {
            display: flex;
            gap: 8px;
        }
        
        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }
        
        .matrix-table th, .matrix-table td {
            padding: 12px 15px;
            border: 1px solid #e0e0e0;
            text-align: center;
        }
        
        .matrix-table th {
            background: linear-gradient(135deg, #4b6cb7, #3a5795);
            color: white;
            font-weight: 600;
        }
        
        .matrix-table .item-name {
            text-align: left;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            font-weight: 600;
            position: sticky;
            left: 0;
            z-index: 1;
            color: #000 !important;
        }
        
        .matrix-table tr:hover .item-name {
            background: linear-gradient(135deg, #e9ecef, #dee2e6);
        }
        
        .hidden-year {
            background: #f8f9fa !important;
            color: #adb5bd !important;
        }
        
        .comparison-controls {
            display: flex;
            gap: 5px;
            margin-top: 5px;
            justify-content: center;
        }
        
        .comparison-controls button {
            padding: 4px 8px;
            font-size: 12px;
            border-radius: 4px;
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 40px;
            color: #7f8c8d;
        }
        
        .empty-state i {
            font-size: 64px;
            margin-bottom: 20px;
            color: #bdc3c7;
        }
        
        .empty-state h3 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #7f8c8d;
        }
        
        .empty-state p {
            font-size: 16px;
            max-width: 500px;
            margin: 0 auto;
        }
        
        .stats-row {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            flex: 1;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 15px;
            border-left: 4px solid #4b6cb7;
        }
        
        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .stat-icon.primary {
            background: linear-gradient(135deg, #4b6cb7, #3a5795);
        }
        
        .stat-icon.success {
            background: linear-gradient(135deg, #27ae60, #219653);
        }
        
        .stat-icon.warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        .stat-icon.info {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .stat-info h3 {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .stat-info p {
            font-size: 14px;
            color: #7f8c8d;
        }
        
        .year-comparison-selector {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 15px 0;
            padding: 15px;
            background: linear-gradient(135deg, #f0f7ff, #e1f0ff);
            border-radius: 10px;
            border: 1px solid #cfe2ff;
        }
        
        .comparison-display {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .comparison-value {
            padding: 8px 15px;
            background: white;
            border-radius: 6px;
            border: 1px solid #ddd;
            min-width: 80px;
            text-align: center;
        }
        
        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            margin-bottom: 15px;
        }
        
        .file-input-wrapper input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            max-width: 400px;
        }
        
        .notification-toast {
            padding: 16px 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideInRight 0.4s ease, fadeOut 0.4s ease 4s forwards;
            position: relative;
            overflow: hidden;
            border-left: 5px solid;
        }
        
        .notification-toast::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.5);
        }
        
        .notification-toast.success {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            border-left-color: #27ae60;
        }
        
        .notification-toast.error {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border-left-color: #e74c3c;
        }
        
        .notification-toast.warning {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            color: #856404;
            border-left-color: #f39c12;
        }
        
        .notification-toast.info {
            background: linear-gradient(135deg, #cce7ff, #b3d9ff);
            color: #004085;
            border-left-color: #3498db;
        }
        
        .notification-icon {
            font-size: 24px;
            flex-shrink: 0;
        }
        
        .notification-content {
            flex: 1;
        }
        
        .notification-title {
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .notification-message {
            font-size: 14px;
        }
        
        .notification-close {
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: inherit;
            opacity: 0.7;
            transition: opacity 0.2s;
        }
        
        .notification-close:hover {
            opacity: 1;
        }
        
        .checkbox-container {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }
        
        .checkbox-container input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .bulk-actions {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #f39c12;
            animation: slideIn 0.3s ease;
        }
        
        .bulk-actions.hidden {
            display: none;
        }
        
        .bulk-selection-info {
            font-weight: 600;
            color: #856404;
        }
        
        .folder-list {
            list-style: none;
            margin-top: 15px;
        }
        
        .folder-item {
            padding: 12px 15px;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid transparent;
        }
        
        .folder-item:hover {
            background: rgba(75, 108, 183, 0.1);
            border-color: rgba(75, 108, 183, 0.2);
        }
        
        .folder-item.active {
            background: linear-gradient(135deg, #4b6cb7, #3a5795);
            color: white;
            box-shadow: 0 3px 8px rgba(75, 108, 183, 0.3);
            border-color: #4b6cb7;
        }
        
        .folder-item i {
            width: 20px;
            text-align: center;
        }
        
        .folder-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .folder-title {
            font-size: 22px;
            font-weight: 700;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .folder-actions {
            display: flex;
            gap: 10px;
        }
        
        .folder-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .folder-modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
        }
        
        .folder-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .folder-modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .folder-modal-close {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #7f8c8d;
        }
        
        .folder-form-group {
            margin-bottom: 20px;
        }
        
        .folder-form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .folder-form-input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 16px;
        }
        
        .folder-form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 25px;
        }
        
        .folder-empty-state {
            text-align: center;
            padding: 60px 40px;
            color: #7f8c8d;
        }
        
        .folder-empty-state i {
            font-size: 64px;
            margin-bottom: 20px;
            color: #bdc3c7;
        }
        
        .folder-empty-state h3 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #7f8c8d;
        }
        
        .folder-empty-state p {
            font-size: 16px;
            max-width: 500px;
            margin: 0 auto 30px;
        }
        
        .folder-selector {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #f0f7ff, #e1f0ff);
            border-radius: 10px;
            border: 1px solid #cfe2ff;
        }
        
        .folder-selector-label {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .folder-selector-select {
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            background: white;
            font-weight: 500;
            min-width: 200px;
        }
        
        .search-container-inline {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-bottom: 1px solid #ddd;
        }
        
        .search-input-wrapper-inline {
            position: relative;
            flex: 1;
        }
        
        .search-input-inline {
            width: 100%;
            padding: 8px 35px 8px 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .search-input-inline:focus {
            outline: none;
            border-color: #4b6cb7;
            box-shadow: 0 0 0 2px rgba(75, 108, 183, 0.1);
        }
        
        .search-icon-inline {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #7f8c8d;
            font-size: 14px;
        }
        
        .search-results-info-inline {
            font-weight: 600;
            color: #2c3e50;
            white-space: nowrap;
            font-size: 12px;
        }
        
        .search-clear-inline {
            background: none;
            border: none;
            color: #7f8c8d;
            cursor: pointer;
            padding: 4px;
            border-radius: 4px;
            transition: all 0.2s ease;
            font-size: 12px;
        }
        
        .search-clear-inline:hover {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }
        
        .compact-import-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .compact-folder-select {
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            background: white;
            font-weight: 500;
            min-width: 150px;
        }
        
        .compact-file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }
        
        .compact-file-input-wrapper .btn-sm {
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .file-input-improved {
            position: relative;
            display: inline-block;
        }
        
        .file-input-improved .btn {
            position: relative;
            z-index: 1;
        }
        
        .file-input-improved input[type="file"] {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
            z-index: 2;
        }
        
        .file-name-display {
            margin-left: 10px;
            font-size: 14px;
            color: #4b6cb7;
            font-weight: 500;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .import-controls-compact {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .sidebar-section {
            margin-bottom: 25px;
        }
        
        .sidebar-section-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .sidebar-section-title i {
            color: #4b6cb7;
            font-size: 14px;
        }
        
        .folder-count {
            margin-left: auto;
            background: #4b6cb7;
            color: white;
            font-size: 12px;
            padding: 2px 8px;
            border-radius: 10px;
            min-width: 24px;
            text-align: center;
        }
        
        .folder-count.active {
            background: #27ae60;
        }
        
        .sidebar-actions {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }
        
        .current-folder-info {
            background: linear-gradient(135deg, #f0f7ff, #e1f0ff);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #4b6cb7;
        }
        
        .current-folder-info h3 {
            font-size: 18px;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .current-folder-info p {
            font-size: 14px;
            color: #7f8c8d;
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100%);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateX(0);
                max-height: 100px;
                margin-bottom: 15px;
                padding: 16px 20px;
                overflow: hidden;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
                border-left: 5px solid;
                display: flex;
                align-items: center;
                gap: 12px;
                position: relative;
            }
            to {
                opacity: 0;
                transform: translateX(100%);
                max-height: 0;
                margin-bottom: 0;
                padding: 0 20px;
                overflow: hidden;
                box-shadow: none;
                border-left: 0;
                display: none;
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @media (max-width: 768px) {
            .login-card {
                padding: 30px 20px;
            }
            
            .login-title {
                font-size: 28px;
            }
            
            .container {
                max-width: 95%;
            }
        }
        
        @media (max-width: 1200px) {
            .container {
                max-width: 95%;
            }
        }
        
        @media (max-width: 992px) {
            .app-content {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
            }
            
            .sidebar.minimized {
                width: 100%;
                height: 60px;
                padding: 10px 20px;
                display: flex;
                align-items: center;
                justify-content: space-between;
            }
            
            .sidebar.minimized .sidebar-toggle {
                margin: 0;
                position: static;
            }
            
            .sidebar.minimized .sidebar-content {
                display: none;
            }
        }
        
        @media (max-width: 768px) {
            .controls-row {
                flex-direction: column;
                align-items: stretch;
            }
            
            .year-controls {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .stats-row {
                flex-direction: column;
            }
            
            .year-comparison-selector {
                flex-direction: column;
                align-items: stretch;
            }
            
            .notification-container {
                max-width: calc(100% - 40px);
                left: 20px;
                right: 20px;
            }
            
            .bulk-actions {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .folder-selector {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .search-container-inline {
                flex-direction: column;
                align-items: stretch;
            }
            
            .compact-import-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .import-controls-compact {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    <div id="notification-container" class="notification-container"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Firebase Configuration - Diperbarui untuk Realtime Database
        const firebaseConfig = {
            apiKey: "AIzaSyCK6XyRds11YteJCXHxrZK0TWULSYJsa4I",
            authDomain: "pricemaster-decfb.firebaseapp.com",
            databaseURL: "https://pricemaster-decfb-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "pricemaster-decfb",
            storageBucket: "pricemaster-decfb.firebasestorage.app",
            messagingSenderId: "848739573910",
            appId: "1:848739573910:web:03859c0dca0f24ed76a2b7"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.database(app); // Realtime Database
        const auth = firebase.auth(app);

        // Database References
        const FOLDERS_REF = 'folders';

        // Fungsi untuk menampilkan notifikasi
        const showNotification = (type, title, message, duration = 5000) => {
            const container = document.getElementById('notification-container');
            const notification = document.createElement('div');
            notification.className = `notification-toast ${type}`;
            
            let iconClass = 'fas fa-info-circle';
            if (type === 'success') iconClass = 'fas fa-check-circle';
            if (type === 'error') iconClass = 'fas fa-exclamation-circle';
            if (type === 'warning') iconClass = 'fas fa-exclamation-triangle';
            
            notification.innerHTML = `
                <div class="notification-icon">
                    <i class="${iconClass}"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <button class="notification-close">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(notification);
            
            const closeNotification = () => {
                notification.style.animation = 'fadeOut 0.4s ease forwards';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 400);
            };
            
            const closeButton = notification.querySelector('.notification-close');
            closeButton.addEventListener('click', closeNotification);
            
            if (duration > 0) {
                setTimeout(closeNotification, duration);
            }
            
            return closeNotification;
        };

        // Helper function untuk mengenerate ID
        const generateId = () => {
            return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
        };

        // Komponen Login Sederhana
        const LoginPage = ({ onLoginSuccess }) => {
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');
            const [success, setSuccess] = useState('');
            
            const handleLogin = async (e) => {
                e.preventDefault();
                
                if (!email || !password) {
                    setError('Email dan password harus diisi');
                    return;
                }
                
                setIsLoading(true);
                setError('');
                setSuccess('');
                
                try {
                    const userCredential = await auth.signInWithEmailAndPassword(email, password);
                    setSuccess('Login berhasil!');
                    
                    // Panggil callback untuk beralih ke aplikasi utama
                    setTimeout(() => {
                        onLoginSuccess(userCredential.user);
                    }, 1500);
                    
                } catch (error) {
                    let errorMessage = 'Terjadi kesalahan saat login';
                    
                    switch (error.code) {
                        case 'auth/invalid-email':
                            errorMessage = 'Format email tidak valid';
                            break;
                        case 'auth/user-disabled':
                            errorMessage = 'Akun ini telah dinonaktifkan';
                            break;
                        case 'auth/user-not-found':
                            errorMessage = 'Akun tidak ditemukan';
                            break;
                        case 'auth/wrong-password':
                            errorMessage = 'Password salah';
                            break;
                        case 'auth/too-many-requests':
                            errorMessage = 'Terlalu banyak percobaan gagal. Coba lagi nanti';
                            break;
                        default:
                            errorMessage = error.message;
                    }
                    
                    setError(errorMessage);
                } finally {
                    setIsLoading(false);
                }
            };
            
            return React.createElement('div', {className: 'login-container'},
                React.createElement('div', {className: 'login-card'},
                    React.createElement('div', {className: 'login-header'},
                        React.createElement('div', {className: 'login-logo'},
                            React.createElement('i', {className: 'fas fa-chart-line'}),
                            React.createElement('h1', {className: 'login-title'}, 'PriceMaster')
                        ),
                        React.createElement('p', {className: 'login-subtitle'}, 'Database dan Analisis Harga Barang')
                    ),
                    
                    React.createElement('form', {onSubmit: handleLogin},
                        React.createElement('div', {className: `login-error ${error ? '' : 'hidden'}`},
                            React.createElement('i', {className: 'fas fa-exclamation-circle'}),
                            error
                        ),
                        
                        React.createElement('div', {className: `login-success ${success ? '' : 'hidden'}`},
                            React.createElement('i', {className: 'fas fa-check-circle'}),
                            success
                        ),
                        
                        React.createElement('div', {className: 'login-form-group'},
                            React.createElement('label', {className: 'login-label'}, 'Email'),
                            React.createElement('input', {
                                type: 'email',
                                className: 'login-input',
                                placeholder: 'Masukkan email',
                                value: email,
                                onChange: (e) => setEmail(e.target.value),
                                required: true
                            })
                        ),
                        
                        React.createElement('div', {className: 'login-form-group'},
                            React.createElement('label', {className: 'login-label'}, 'Password'),
                            React.createElement('input', {
                                type: 'password',
                                className: 'login-input',
                                placeholder: 'Masukkan password',
                                value: password,
                                onChange: (e) => setPassword(e.target.value),
                                required: true
                            })
                        ),
                        
                        React.createElement('button', {
                            type: 'submit',
                            className: 'login-btn',
                            disabled: isLoading
                        },
                            isLoading ? React.createElement('span', {className: 'login-loading'}) : React.createElement('i', {className: 'fas fa-sign-in-alt'}),
                            isLoading ? 'Memproses...' : 'Login'
                        )
                    )
                )
            );
        };

        // Komponen Aplikasi Utama dengan Realtime Database
        const MainApp = ({ user }) => {
            const [folders, setFolders] = useState([]);
            const [activeFolder, setActiveFolder] = useState(null);
            const [items, setItems] = useState([]);
            const [filteredItems, setFilteredItems] = useState([]);
            const [selectedItem, setSelectedItem] = useState(null);
            const [selectedItems, setSelectedItems] = useState([]);
            const [chartData, setChartData] = useState([]);
            const [fileName, setFileName] = useState('');
            const [hiddenYears, setHiddenYears] = useState([]);
            const [viewMode, setViewMode] = useState('matrix');
            const [comparison, setComparison] = useState({ from: null, to: null });
            const [currentPage, setCurrentPage] = useState(1);
            const [itemsPerPage, setItemsPerPage] = useState(10);
            const [showFolderModal, setShowFolderModal] = useState(false);
            const [newFolderName, setNewFolderName] = useState('');
            const [selectedFolderForImport, setSelectedFolderForImport] = useState('');
            const [searchQuery, setSearchQuery] = useState('');
            const [sidebarMinimized, setSidebarMinimized] = useState(false);
            const [isLoading, setIsLoading] = useState(true);

            // Load folders dari Realtime Database berdasarkan user ID
            useEffect(() => {
                const loadFoldersFromDatabase = async () => {
                    try {
                        setIsLoading(true);
                        
                        // Get user's folders from Realtime Database
                        const foldersRef = db.ref(`${FOLDERS_REF}/${user.uid}`);
                        
                        const snapshot = await foldersRef.once('value');
                        
                        if (snapshot.exists()) {
                            const foldersData = [];
                            const data = snapshot.val();
                            
                            Object.keys(data).forEach(folderId => {
                                const folder = data[folderId];
                                foldersData.push({
                                    id: folderId,
                                    name: folder.name,
                                    items: folder.items || [],
                                    userId: folder.userId || user.uid,
                                    createdAt: folder.createdAt ? new Date(folder.createdAt) : new Date(),
                                    updatedAt: folder.updatedAt ? new Date(folder.updatedAt) : new Date()
                                });
                            });
                            
                            setFolders(foldersData);
                            
                            // Set active folder dari localStorage
                            const savedActiveFolder = localStorage.getItem(`priceMasterActiveFolder_${user.uid}`);
                            if (savedActiveFolder && foldersData.some(f => f.id === savedActiveFolder)) {
                                setActiveFolder(savedActiveFolder);
                            } else if (foldersData.length > 0) {
                                setActiveFolder(foldersData[0].id);
                            }
                            
                            showNotification('success', 'Data Dimuat', 'Data berhasil dimuat dari database');
                        } else {
                            // Create default folders if none exist
                            createDefaultFolders();
                        }
                    } catch (error) {
                        console.error('Error loading folders:', error);
                        showNotification('error', 'Kesalahan', 'Gagal memuat data dari database');
                    } finally {
                        setIsLoading(false);
                    }
                };

                if (user.uid) {
                    loadFoldersFromDatabase();
                }
            }, [user.uid]);

            // Setup realtime listener untuk folder
            useEffect(() => {
                if (!user.uid) return;
                
                const foldersRef = db.ref(`${FOLDERS_REF}/${user.uid}`);
                
                const handleDataChange = (snapshot) => {
                    if (snapshot.exists()) {
                        const foldersData = [];
                        const data = snapshot.val();
                        
                        Object.keys(data).forEach(folderId => {
                            const folder = data[folderId];
                            foldersData.push({
                                id: folderId,
                                name: folder.name,
                                items: folder.items || [],
                                userId: folder.userId || user.uid,
                                createdAt: folder.createdAt ? new Date(folder.createdAt) : new Date(),
                                updatedAt: folder.updatedAt ? new Date(folder.updatedAt) : new Date()
                            });
                        });
                        
                        setFolders(foldersData);
                    }
                };
                
                foldersRef.on('value', handleDataChange);
                
                return () => {
                    foldersRef.off('value', handleDataChange);
                };
            }, [user.uid]);

            // Create default folders
            const createDefaultFolders = async () => {
                try {
                    const defaultFolders = [
                        { 
                            name: 'VESDA', 
                            items: [],
                            userId: user.uid,
                            createdAt: new Date().toISOString(),
                            updatedAt: new Date().toISOString()
                        },
                        { 
                            name: 'SIMPLEX', 
                            items: [],
                            userId: user.uid,
                            createdAt: new Date().toISOString(),
                            updatedAt: new Date().toISOString()
                        }
                    ];

                    const folderRefs = [];
                    
                    for (const folderData of defaultFolders) {
                        const newFolderRef = db.ref(`${FOLDERS_REF}/${user.uid}`).push();
                        await newFolderRef.set(folderData);
                        
                        folderRefs.push({ 
                            id: newFolderRef.key, 
                            ...folderData 
                        });
                    }
                    
                    setFolders(folderRefs);
                    if (folderRefs.length > 0) {
                        setActiveFolder(folderRefs[0].id);
                        localStorage.setItem(`priceMasterActiveFolder_${user.uid}`, folderRefs[0].id);
                    }
                    
                    showNotification('success', 'Folder Default Dibuat', 'Folder VESDA dan SIMPLEX telah dibuat');
                } catch (error) {
                    console.error('Error creating default folders:', error);
                    showNotification('error', 'Kesalahan', 'Gagal membuat folder default');
                }
            };

            // Load items dari active folder
            useEffect(() => {
                if (activeFolder && folders.length > 0) {
                    const folder = folders.find(f => f.id === activeFolder);
                    if (folder) {
                        setItems(folder.items || []);
                        setSelectedFolderForImport(activeFolder);
                    }
                } else {
                    setItems([]);
                }
            }, [activeFolder, folders]);

            // Filter items berdasarkan search query
            useEffect(() => {
                if (searchQuery.trim() === '') {
                    setFilteredItems(items);
                } else {
                    const query = searchQuery.toLowerCase();
                    const filtered = items.filter(item => 
                        item.name && item.name.toLowerCase().includes(query)
                    );
                    setFilteredItems(filtered);
                }
                setCurrentPage(1);
            }, [items, searchQuery]);

            // Save active folder to localStorage
            useEffect(() => {
                if (activeFolder && user.uid) {
                    localStorage.setItem(`priceMasterActiveFolder_${user.uid}`, activeFolder);
                }
            }, [activeFolder, user.uid]);

            // Save sidebar state
            useEffect(() => {
                localStorage.setItem('priceMasterSidebarMinimized', JSON.stringify(sidebarMinimized));
            }, [sidebarMinimized]);

            // Update chart data ketika items berubah
            useEffect(() => {
                if (selectedItem) {
                    updateChartData(selectedItem);
                }
            }, [items, selectedItem]);

            // Reset selected items ketika items berubah
            useEffect(() => {
                setSelectedItems([]);
            }, [items]);

            // Dapatkan semua tahun unik dari data
            const getAllYears = () => {
                const years = new Set();
                items.forEach(item => {
                    if (item.prices) {
                        item.prices.forEach(price => {
                            years.add(price.year);
                        });
                    }
                });
                return Array.from(years).sort((a, b) => a - b);
            };

            // Pagination logic
            const indexOfLastItem = currentPage * itemsPerPage;
            const indexOfFirstItem = indexOfLastItem - itemsPerPage;
            const currentItems = filteredItems.slice(indexOfFirstItem, indexOfLastItem);
            const totalPages = Math.ceil(filteredItems.length / itemsPerPage);

            // Stats calculations
            const totalItems = items.length;
            const totalFilteredItems = filteredItems.length;
            const totalYears = getAllYears().length;
            const priceChanges = items.filter(item => 
                item.prices && 
                item.prices.length > 1 && 
                item.prices[item.prices.length - 1].price !== item.prices[0].price
            ).length;

            // Fungsi untuk membuat folder baru dan langsung save ke Realtime Database
            const createNewFolder = async () => {
                if (!newFolderName.trim()) {
                    showNotification('warning', 'Peringatan', 'Nama folder tidak boleh kosong');
                    return;
                }

                if (folders.some(f => f.name.toLowerCase() === newFolderName.toLowerCase())) {
                    showNotification('warning', 'Peringatan', 'Folder dengan nama tersebut sudah ada');
                    return;
                }

                try {
                    const newFolderData = {
                        name: newFolderName,
                        items: [],
                        userId: user.uid,
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    };

                    const newFolderRef = db.ref(`${FOLDERS_REF}/${user.uid}`).push();
                    await newFolderRef.set(newFolderData);
                    
                    const newFolder = {
                        id: newFolderRef.key,
                        ...newFolderData
                    };

                    setNewFolderName('');
                    setShowFolderModal(false);
                    
                    showNotification('success', 'Berhasil', `Folder "${newFolderName}" berhasil dibuat`);
                } catch (error) {
                    console.error('Error creating folder:', error);
                    showNotification('error', 'Kesalahan', 'Gagal membuat folder');
                }
            };

            // Fungsi untuk menghapus folder dari Realtime Database
            const deleteFolder = async (folderId) => {
                if (folders.length <= 1) {
                    showNotification('warning', 'Peringatan', 'Tidak dapat menghapus folder terakhir');
                    return;
                }

                const folderToDelete = folders.find(f => f.id === folderId);
                if (!folderToDelete) return;

                if (window.confirm(`Apakah Anda yakin ingin menghapus folder "${folderToDelete.name}"? Semua data di dalamnya akan hilang.`)) {
                    try {
                        // Hapus dari Realtime Database
                        await db.ref(`${FOLDERS_REF}/${user.uid}/${folderId}`).remove();
                        
                        if (activeFolder === folderId) {
                            const remainingFolders = folders.filter(f => f.id !== folderId);
                            if (remainingFolders.length > 0) {
                                setActiveFolder(remainingFolders[0].id);
                            } else {
                                setActiveFolder(null);
                            }
                        }

                        showNotification('success', 'Berhasil', `Folder "${folderToDelete.name}" berhasil dihapus`);
                    } catch (error) {
                        console.error('Error deleting folder:', error);
                        showNotification('error', 'Kesalahan', 'Gagal menghapus folder');
                    }
                }
            };

            // Fungsi untuk menghapus item tunggal dan update Realtime Database
            const deleteItem = async (id) => {
                if (window.confirm('Apakah Anda yakin ingin menghapus item ini?')) {
                    try {
                        const updatedItems = items.filter(item => item.id !== id);
                        await updateFolderItems(activeFolder, updatedItems);
                        
                        if (selectedItem && selectedItem.id === id) {
                            setSelectedItem(null);
                        }
                        showNotification('success', 'Berhasil', 'Item berhasil dihapus');
                    } catch (error) {
                        showNotification('error', 'Kesalahan', 'Gagal menghapus item');
                    }
                }
            };

            // Fungsi untuk menghapus multiple items dan update Realtime Database
            const deleteSelectedItems = async () => {
                if (selectedItems.length === 0) {
                    showNotification('warning', 'Peringatan', 'Tidak ada item yang dipilih untuk dihapus');
                    return;
                }

                if (window.confirm(`Apakah Anda yakin ingin menghapus ${selectedItems.length} item yang dipilih?`)) {
                    try {
                        const updatedItems = items.filter(item => !selectedItems.includes(item.id));
                        await updateFolderItems(activeFolder, updatedItems);
                        
                        setSelectedItems([]);
                        if (selectedItem && selectedItems.includes(selectedItem.id)) {
                            setSelectedItem(null);
                        }
                        showNotification('success', 'Berhasil', `${selectedItems.length} item berhasil dihapus`);
                    } catch (error) {
                        showNotification('error', 'Kesalahan', 'Gagal menghapus item');
                    }
                }
            };

            // Fungsi untuk memperbarui items di folder dan langsung save ke Realtime Database
            const updateFolderItems = async (folderId, newItems) => {
                try {
                    // Update di Realtime Database
                    await db.ref(`${FOLDERS_REF}/${user.uid}/${folderId}`).update({
                        items: newItems,
                        updatedAt: new Date().toISOString()
                    });
                } catch (error) {
                    console.error('Error updating folder items:', error);
                    throw error;
                }
            };

            // Fungsi untuk memilih/deselect item
            const toggleItemSelection = (id) => {
                if (selectedItems.includes(id)) {
                    setSelectedItems(selectedItems.filter(itemId => itemId !== id));
                } else {
                    setSelectedItems([...selectedItems, id]);
                }
            };

            // Fungsi untuk memilih semua item di halaman saat ini
            const toggleSelectAll = () => {
                const currentPageIds = currentItems.map(item => item.id);
                const allSelected = currentPageIds.every(id => selectedItems.includes(id));
                
                if (allSelected) {
                    setSelectedItems(selectedItems.filter(id => !currentPageIds.includes(id)));
                } else {
                    const newSelected = [...selectedItems];
                    currentPageIds.forEach(id => {
                        if (!newSelected.includes(id)) {
                            newSelected.push(id);
                        }
                    });
                    setSelectedItems(newSelected);
                }
            };

            const selectItem = (item) => {
                setSelectedItem(item);
                updateChartData(item);
            };

            const updateChartData = (item) => {
                if (!item || !item.prices || item.prices.length === 0) {
                    setChartData([]);
                    return;
                }

                const data = item.prices.map(priceData => ({
                    year: priceData.year,
                    price: priceData.price
                }));

                setChartData(data);
            };

            const formatPrice = (price) => {
                if (!price) return '-';
                return new Intl.NumberFormat('id-ID', {
                    style: 'currency',
                    currency: 'IDR',
                    minimumFractionDigits: 0
                }).format(price);
            };

            const calculatePercentageChange = (currentPrice, previousPrice) => {
                if (!previousPrice || previousPrice === 0) return null;
                
                const change = ((currentPrice - previousPrice) / previousPrice) * 100;
                return change.toFixed(2);
            };

            const getPriceChangeClass = (change) => {
                if (!change) return 'no-change';
                return change > 0 ? 'price-increase' : change < 0 ? 'price-decrease' : 'no-change';
            };

            const getLatestPrice = (prices) => {
                if (!prices || prices.length === 0) return 0;
                return prices[prices.length - 1].price;
            };

            const getPriceForYear = (item, year) => {
                if (!item.prices) return null;
                const priceData = item.prices.find(p => p.year === year);
                return priceData ? priceData.price : null;
            };

            // Fungsi untuk mendapatkan perubahan harga berdasarkan tahun yang dipilih
            const getPriceChangeForComparison = (item) => {
                if (!comparison.from || !comparison.to) return null;
                
                const fromPrice = getPriceForYear(item, comparison.from);
                const toPrice = getPriceForYear(item, comparison.to);
                
                if (!fromPrice || !toPrice) return null;
                
                return calculatePercentageChange(toPrice, fromPrice);
            };

            // Fungsi untuk menangani import file Excel
            const handleFileImport = async (e) => {
                const file = e.target.files[0];
                if (!file) return;
                
                if (!selectedFolderForImport) {
                    showNotification('error', 'Kesalahan', 'Pilih folder tujuan sebelum mengimpor data');
                    return;
                }
                
                setFileName(file.name);
                
                const reader = new FileReader();
                
                reader.onload = async function(event) {
                    try {
                        const data = new Uint8Array(event.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        
                        const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                        
                        // Fungsi untuk mendapatkan nilai sel berdasarkan koordinat
                        const getCellValue = (cellAddress) => {
                            return worksheet[cellAddress] ? worksheet[cellAddress].v : null;
                        };
                        
                        // Ambil data berdasarkan format yang ditentukan
                        const importedItems = [];
                        const processedItems = [];
                        const skippedItems = [];
                        
                        // Mulai dari baris 8 (sesuai permintaan)
                        let row = 8;
                        
                        while (true) {
                            // Ambil data dari kolom C, G, H
                            const partCode = getCellValue('C' + row);
                            const listPrice = getCellValue('G' + row);
                            const year = getCellValue('H' + row);
                            
                            // Jika tidak ada data di kolom C, berhenti
                            if (!partCode && !listPrice && !year) {
                                break;
                            }
                            
                            // Validasi data
                            if (!partCode || !listPrice || !year) {
                                skippedItems.push({
                                    row: row,
                                    reason: 'Data tidak lengkap'
                                });
                                row++;
                                continue;
                            }
                            
                            // Konversi harga ke angka
                            let priceValue;
                            if (typeof listPrice === 'string') {
                                const cleanedPrice = listPrice.replace(/[^\d,.-]/g, '');
                                
                                if (cleanedPrice.includes(',') && !cleanedPrice.includes('.')) {
                                    priceValue = parseFloat(cleanedPrice.replace(',', '.'));
                                } else if (cleanedPrice.includes('.') && cleanedPrice.includes(',')) {
                                    priceValue = parseFloat(cleanedPrice.replace(/\./g, '').replace(',', '.'));
                                } else {
                                    priceValue = parseFloat(cleanedPrice);
                                }
                            } else {
                                priceValue = parseFloat(listPrice);
                            }
                            
                            // Konversi tahun ke angka
                            let yearValue;
                            if (typeof year === 'string') {
                                yearValue = parseInt(year.replace(/\D/g, ''));
                            } else if (typeof year === 'number') {
                                yearValue = Math.floor(year);
                            } else {
                                skippedItems.push({
                                    row: row,
                                    reason: 'Format tahun tidak valid'
                                });
                                row++;
                                continue;
                            }
                            
                            if (isNaN(priceValue) || isNaN(yearValue)) {
                                skippedItems.push({
                                    row: row,
                                    reason: 'Format angka tidak valid'
                                });
                                row++;
                                continue;
                            }
                            
                            // Cari item yang sudah ada di data yang diimpor
                            const existingItemIndex = importedItems.findIndex(item => 
                                item.name.toLowerCase() === partCode.toString().toLowerCase()
                            );
                            
                            if (existingItemIndex !== -1) {
                                // Tambahkan harga ke item yang sudah ada
                                importedItems[existingItemIndex].prices.push({
                                    year: yearValue,
                                    price: priceValue
                                });
                                
                                // Urutkan berdasarkan tahun
                                importedItems[existingItemIndex].prices.sort((a, b) => a.year - b.year);
                            } else {
                                // Buat item baru
                                importedItems.push({
                                    id: generateId(),
                                    name: partCode.toString(),
                                    prices: [{
                                        year: yearValue,
                                        price: priceValue
                                    }]
                                });
                            }
                            
                            processedItems.push({
                                row: row,
                                partCode: partCode,
                                price: priceValue,
                                year: yearValue
                            });
                            
                            row++;
                        }
                        
                        // Dapatkan folder target
                        const targetFolder = folders.find(f => f.id === selectedFolderForImport);
                        if (!targetFolder) {
                            showNotification('error', 'Kesalahan', 'Folder tujuan tidak ditemukan');
                            return;
                        }
                        
                        // Gabungkan dengan data yang sudah ada di folder target
                        const existingItems = targetFolder.items || [];
                        const updatedItems = [...existingItems];
                        
                        importedItems.forEach(importedItem => {
                            const existingIndex = updatedItems.findIndex(item => 
                                item.name.toLowerCase() === importedItem.name.toLowerCase()
                            );
                            
                            if (existingIndex !== -1) {
                                // Gabungkan data harga
                                importedItem.prices.forEach(priceData => {
                                    const existingPriceIndex = updatedItems[existingIndex].prices.findIndex(
                                        p => p.year === priceData.year
                                    );
                                    
                                    if (existingPriceIndex !== -1) {
                                        // Update harga yang sudah ada
                                        updatedItems[existingIndex].prices[existingPriceIndex].price = priceData.price;
                                    } else {
                                        // Tambahkan harga baru
                                        updatedItems[existingIndex].prices.push(priceData);
                                    }
                                });
                                
                                // Urutkan kembali berdasarkan tahun
                                updatedItems[existingIndex].prices.sort((a, b) => a.year - b.year);
                            } else {
                                // Tambahkan item baru
                                updatedItems.push(importedItem);
                            }
                        });
                        
                        // Update folder dengan items baru
                        await updateFolderItems(selectedFolderForImport, updatedItems);
                        
                        if (processedItems.length > 0) {
                            let message = `Berhasil mengimpor ${processedItems.length} data barang ke folder "${targetFolder.name}".`;
                            
                            if (skippedItems.length > 0) {
                                message += ` ${skippedItems.length} data dilewati karena format tidak valid.`;
                            }
                            
                            showNotification('success', 'Import Berhasil', message);
                        } else {
                            showNotification('warning', 'Tidak Ada Data', 'Tidak ada data yang berhasil diimpor');
                        }
                        
                    } catch (error) {
                        console.error('Error reading Excel file:', error);
                        showNotification('error', 'Kesalahan', 'Terjadi kesalahan saat membaca file Excel');
                    }
                };
                
                reader.onerror = function() {
                    showNotification('error', 'Kesalahan', 'Terjadi kesalahan saat membaca file');
                };
                
                reader.readAsArrayBuffer(file);
                
                // Reset file input
                e.target.value = '';
                setFileName('');
            };

            // Fungsi untuk toggle hide tahun
            const toggleYearVisibility = (year) => {
                if (hiddenYears.includes(year)) {
                    setHiddenYears(hiddenYears.filter(y => y !== year));
                } else {
                    setHiddenYears([...hiddenYears, year]);
                }
            };

            // Fungsi untuk toggle semua tahun
            const toggleAllYears = () => {
                const allYears = getAllYears();
                if (hiddenYears.length === allYears.length) {
                    setHiddenYears([]);
                } else {
                    setHiddenYears(allYears);
                }
            };

            // Fungsi untuk set perbandingan
            const setComparisonYears = (fromYear, toYear) => {
                setComparison({ from: fromYear, to: toYear });
            };

            // Fungsi untuk reset perbandingan
            const resetComparison = () => {
                setComparison({ from: null, to: null });
            };

            // Fungsi untuk menghapus pencarian
            const clearSearch = () => {
                setSearchQuery('');
            };

            // Fungsi untuk toggle minimize sidebar
            const toggleSidebar = () => {
                setSidebarMinimized(!sidebarMinimized);
            };

            if (isLoading) {
                return React.createElement('div', {className: 'container'},
                    React.createElement('header', null,
                        React.createElement('div', {className: 'logo'},
                            React.createElement('i', {className: 'fas fa-chart-line'}),
                            React.createElement('h1', null, 'PriceMaster')
                        ),
                        React.createElement('p', {className: 'description'}, 'Database dan Analisis Harga Barang')
                    ),
                    React.createElement('div', {className: 'app-content'},
                        React.createElement('div', {className: 'main-content', style: {textAlign: 'center', padding: '60px 40px'}},
                            React.createElement('div', {className: 'login-loading', style: {width: '50px', height: '50px', margin: '30px auto'}}),
                            React.createElement('p', {style: {color: '#7f8c8d', marginTop: '20px'}}, 'Memuat data dari server...')
                        )
                    )
                );
            }

            return React.createElement('div', {className: 'container'},
                React.createElement('header', null,
                    React.createElement('div', {className: 'logo'},
                        React.createElement('i', {className: 'fas fa-chart-line'}),
                        React.createElement('h1', null, 'PriceMaster')
                    ),
                    React.createElement('p', {className: 'description'}, 'Database dan Analisis Harga Barang')
                ),
                
                React.createElement('div', {className: 'app-content'},
                    // Sidebar
                    React.createElement('div', {className: `sidebar ${sidebarMinimized ? 'minimized' : ''}`},
                        React.createElement('button', {
                            className: 'sidebar-toggle',
                            onClick: toggleSidebar,
                            title: sidebarMinimized ? 'Perluas Sidebar' : 'Minimalkan Sidebar'
                        },
                            React.createElement('i', {className: sidebarMinimized ? 'fas fa-chevron-right' : 'fas fa-chevron-left'})
                        ),
                        
                        React.createElement('div', {className: 'sidebar-content'},
                            React.createElement('div', {className: 'sidebar-section'},
                                React.createElement('div', {className: 'sidebar-section-title'},
                                    React.createElement('i', {className: 'fas fa-folder'}),
                                    'Folder Data',
                                    React.createElement('span', {className: `folder-count ${activeFolder ? 'active' : ''}`}, folders.length)
                                ),
                                
                                React.createElement('ul', {className: 'folder-list'},
                                    folders.map(folder => 
                                        React.createElement('li', {
                                            key: folder.id,
                                            className: `folder-item ${activeFolder === folder.id ? 'active' : ''}`,
                                            onClick: () => setActiveFolder(folder.id)
                                        },
                                            React.createElement('i', {className: 'fas fa-folder'}),
                                            folder.name,
                                            React.createElement('span', {
                                                style: {
                                                    marginLeft: 'auto',
                                                    fontSize: '12px',
                                                    background: activeFolder === folder.id ? 'rgba(255,255,255,0.3)' : 'rgba(75, 108, 183, 0.1)',
                                                    padding: '2px 8px',
                                                    borderRadius: '10px',
                                                    minWidth: '24px',
                                                    textAlign: 'center'
                                                }
                                            }, folder.items ? folder.items.length : 0)
                                        )
                                    )
                                )
                            ),
                            
                            React.createElement('div', {className: 'sidebar-actions'},
                                React.createElement('button', {
                                    className: 'btn btn-success',
                                    onClick: () => setShowFolderModal(true),
                                    style: {width: '100%'}
                                },
                                    React.createElement('i', {className: 'fas fa-plus'}),
                                    ' Folder Baru'
                                )
                            ),
                            
                            activeFolder && React.createElement('div', {className: 'sidebar-section', style: {marginTop: '20px'}},
                                React.createElement('div', {className: 'current-folder-info'},
                                    React.createElement('h3', null,
                                        React.createElement('i', {className: 'fas fa-folder-open'}),
                                        folders.find(f => f.id === activeFolder)?.name || 'Folder'
                                    ),
                                    React.createElement('p', null,
                                        items.length, ' barang  ',
                                        getAllYears().length, ' tahun data'
                                    )
                                ),
                                
                                folders.length > 1 && React.createElement('button', {
                                    className: 'btn btn-outline',
                                    onClick: () => deleteFolder(activeFolder),
                                    style: {width: '100%', marginTop: '10px'}
                                },
                                    React.createElement('i', {className: 'fas fa-trash'}),
                                    ' Hapus Folder'
                                )
                            )
                        )
                    ),
                    
                    // Main Content
                    React.createElement('div', {className: 'main-content'},
                        activeFolder ? React.createElement(React.Fragment, null,
                            // Import Controls
                            React.createElement('div', {className: 'import-controls-compact'},
                                React.createElement('select', {
                                    className: 'compact-folder-select',
                                    value: selectedFolderForImport,
                                    onChange: (e) => setSelectedFolderForImport(e.target.value)
                                },
                                    folders.map(folder => 
                                        React.createElement('option', {key: folder.id, value: folder.id}, folder.name)
                                    )
                                ),
                                React.createElement('div', {className: 'file-input-improved'},
                                    React.createElement('button', {className: 'btn btn-success btn-sm'},
                                        React.createElement('i', {className: 'fas fa-file-import'}),
                                        fileName ? fileName : 'Import Excel'
                                    ),
                                    React.createElement('input', {
                                        type: 'file',
                                        accept: '.xlsx, .xls',
                                        onChange: handleFileImport
                                    })
                                ),
                                fileName && React.createElement('span', {className: 'file-name-display'},
                                    React.createElement('i', {className: 'fas fa-check-circle', style: {color: '#27ae60', marginRight: '5px'}}),
                                    fileName
                                )
                            ),
                            
                            items.length > 0 ? React.createElement(React.Fragment, null,
                                React.createElement('div', {className: 'stats-row'},
                                    React.createElement('div', {className: 'stat-card'},
                                        React.createElement('div', {className: 'stat-icon primary'},
                                            React.createElement('i', {className: 'fas fa-boxes'})
                                        ),
                                        React.createElement('div', {className: 'stat-info'},
                                            React.createElement('h3', null, totalItems),
                                            React.createElement('p', null, 'Total Barang')
                                        )
                                    ),
                                    React.createElement('div', {className: 'stat-card'},
                                        React.createElement('div', {className: 'stat-icon success'},
                                            React.createElement('i', {className: 'fas fa-calendar-alt'})
                                        ),
                                        React.createElement('div', {className: 'stat-info'},
                                            React.createElement('h3', null, totalYears),
                                            React.createElement('p', null, 'Tahun Data')
                                        )
                                    ),
                                    React.createElement('div', {className: 'stat-card'},
                                        React.createElement('div', {className: 'stat-icon warning'},
                                            React.createElement('i', {className: 'fas fa-chart-line'})
                                        ),
                                        React.createElement('div', {className: 'stat-info'},
                                            React.createElement('h3', null, priceChanges),
                                            React.createElement('p', null, 'Perubahan Harga')
                                        )
                                    ),
                                    React.createElement('div', {className: 'stat-card'},
                                        React.createElement('div', {className: 'stat-icon info'},
                                            React.createElement('i', {className: 'fas fa-cloud'}),
                                        ),
                                        React.createElement('div', {className: 'stat-info'},
                                            React.createElement('h3', null, 'Realtime'),
                                            React.createElement('p', null, 'Database')
                                        )
                                    )
                                ),
                                
                                // Bulk Actions
                                React.createElement('div', {className: `bulk-actions ${selectedItems.length > 0 ? '' : 'hidden'}`},
                                    React.createElement('div', {className: 'bulk-selection-info'},
                                        React.createElement('i', {className: 'fas fa-check-circle'}),
                                        ` ${selectedItems.length} item dipilih`
                                    ),
                                    React.createElement('div', {style: {display: 'flex', gap: '10px'}},
                                        React.createElement('button', {
                                            className: 'btn btn-danger btn-sm',
                                            onClick: deleteSelectedItems
                                        },
                                            React.createElement('i', {className: 'fas fa-trash'}),
                                            ' Hapus yang Dipilih'
                                        ),
                                        React.createElement('button', {
                                            className: 'btn btn-outline btn-sm',
                                            onClick: () => setSelectedItems([])
                                        },
                                            React.createElement('i', {className: 'fas fa-times'}),
                                            ' Batalkan Pilihan'
                                        )
                                    )
                                ),
                                
                                React.createElement('div', {className: 'card'},
                                    React.createElement('div', {className: 'controls-row'},
                                        React.createElement('div', {className: 'view-toggle'},
                                            React.createElement('button', {
                                                className: viewMode === 'matrix' ? 'active' : '',
                                                onClick: () => setViewMode('matrix')
                                            },
                                                React.createElement('i', {className: 'fas fa-table'}),
                                                ' Tampilan Matrix'
                                            ),
                                            React.createElement('button', {
                                                className: viewMode === 'list' ? 'active' : '',
                                                onClick: () => setViewMode('list')
                                            },
                                                React.createElement('i', {className: 'fas fa-list'}),
                                                ' Tampilan List'
                                            )
                                        ),
                                        
                                        React.createElement('div', {className: 'pagination-controls'},
                                            React.createElement('span', null, 'Tampilkan: '),
                                            React.createElement('select', {
                                                className: 'page-size-select',
                                                value: itemsPerPage,
                                                onChange: (e) => {
                                                    setItemsPerPage(Number(e.target.value));
                                                    setCurrentPage(1);
                                                }
                                            },
                                                React.createElement('option', {value: '10'}, '10'),
                                                React.createElement('option', {value: '25'}, '25'),
                                                React.createElement('option', {value: '50'}, '50'),
                                                React.createElement('option', {value: '100'}, '100')
                                            ),
                                            
                                            React.createElement('div', {className: 'pagination'},
                                                React.createElement('button', {
                                                    onClick: () => setCurrentPage(prev => Math.max(prev - 1, 1)),
                                                    disabled: currentPage === 1
                                                },
                                                    React.createElement('i', {className: 'fas fa-chevron-left'})
                                                ),
                                                
                                                Array.from({ length: Math.min(5, totalPages) }, (_, i) => {
                                                    const pageNum = i + 1;
                                                    return React.createElement('button', {
                                                        key: pageNum,
                                                        className: currentPage === pageNum ? 'active' : '',
                                                        onClick: () => setCurrentPage(pageNum)
                                                    }, pageNum);
                                                }),
                                                
                                                totalPages > 5 && React.createElement('span', {style: {padding: '8px 12px'}}, '...'),
                                                
                                                React.createElement('button', {
                                                    onClick: () => setCurrentPage(prev => Math.min(prev + 1, totalPages)),
                                                    disabled: currentPage === totalPages
                                                },
                                                    React.createElement('i', {className: 'fas fa-chevron-right'})
                                                )
                                            )
                                        )
                                    ),

                                    // Year Controls
                                    React.createElement('div', {className: 'year-controls'},
                                        React.createElement('div', {style: {fontWeight: '600', color: '#2c3e50'}}, 'Tampilkan Tahun:'),
                                        React.createElement('div', {
                                            className: 'year-checkbox',
                                            onClick: toggleAllYears
                                        },
                                            React.createElement('input', {
                                                type: 'checkbox',
                                                checked: hiddenYears.length !== getAllYears().length,
                                                onChange: () => {}
                                            }),
                                            React.createElement('span', null, 'Pilih Semua')
                                        ),
                                        getAllYears().map(year => 
                                            React.createElement('div', {
                                                key: year,
                                                className: `year-checkbox ${!hiddenYears.includes(year) ? 'checked' : ''}`,
                                                onClick: () => toggleYearVisibility(year)
                                            },
                                                React.createElement('input', {
                                                    type: 'checkbox',
                                                    checked: !hiddenYears.includes(year),
                                                    onChange: () => {}
                                                }),
                                                React.createElement('span', null, year)
                                            )
                                        )
                                    ),

                                    // Year Comparison Selector
                                    React.createElement('div', {className: 'year-comparison-selector'},
                                        React.createElement('div', {style: {fontWeight: '600', color: '#2c3e50'}}, 'Perbandingan Harga:'),
                                        React.createElement('select', {
                                            value: comparison.from || '',
                                            onChange: (e) => setComparisonYears(e.target.value ? parseInt(e.target.value) : null, comparison.to),
                                            style: {padding: '8px 12px', borderRadius: '6px', border: '1px solid #ddd'}
                                        },
                                            React.createElement('option', {value: ''}, 'Pilih Tahun Awal'),
                                            getAllYears().map(year => 
                                                React.createElement('option', {key: `from-${year}`, value: year}, year)
                                            )
                                        ),
                                        React.createElement('span', {style: {fontWeight: '600'}}, ''),
                                        React.createElement('select', {
                                            value: comparison.to || '',
                                            onChange: (e) => setComparisonYears(comparison.from, e.target.value ? parseInt(e.target.value) : null),
                                            style: {padding: '8px 12px', borderRadius: '6px', border: '1px solid #ddd'}
                                        },
                                            React.createElement('option', {value: ''}, 'Pilih Tahun Akhir'),
                                            getAllYears().map(year => 
                                                React.createElement('option', {key: `to-${year}`, value: year}, year)
                                            )
                                        ),
                                        comparison.from && comparison.to && React.createElement('button', {
                                            onClick: resetComparison,
                                            className: 'btn btn-warning btn-sm'
                                        },
                                            React.createElement('i', {className: 'fas fa-times'}),
                                            ' Reset'
                                        )
                                    ),

                                    viewMode === 'matrix' ? React.createElement('div', {className: 'matrix-view'},
                                        React.createElement('table', {className: 'matrix-table'},
                                            React.createElement('thead', null,
                                                React.createElement('tr', null,
                                                    React.createElement('th', {style: {width: '50px'}},
                                                        React.createElement('div', {className: 'checkbox-container'},
                                                            React.createElement('input', {
                                                                type: 'checkbox',
                                                                checked: currentItems.length > 0 && currentItems.every(item => selectedItems.includes(item.id)),
                                                                onChange: toggleSelectAll
                                                            })
                                                        )
                                                    ),
                                                    React.createElement('th', {className: 'item-name'},
                                                        React.createElement('div', {style: {display: 'flex', flexDirection: 'column', gap: '5px'}},
                                                            React.createElement('span', null, 'Nama Barang (Part Code)'),
                                                            // Search Bar - Di dalam header kolom Nama Barang
                                                            React.createElement('div', {className: 'search-container-inline'},
                                                                React.createElement('div', {className: 'search-input-wrapper-inline'},
                                                                    React.createElement('input', {
                                                                        type: 'text',
                                                                        className: 'search-input-inline',
                                                                        placeholder: 'Cari Part Code...',
                                                                        value: searchQuery,
                                                                        onChange: (e) => setSearchQuery(e.target.value)
                                                                    }),
                                                                    React.createElement('div', {className: 'search-icon-inline'},
                                                                        React.createElement('i', {className: 'fas fa-search'})
                                                                    )
                                                                ),
                                                                searchQuery && React.createElement('button', {
                                                                    className: 'search-clear-inline',
                                                                    onClick: clearSearch,
                                                                    title: 'Hapus pencarian'
                                                                },
                                                                    React.createElement('i', {className: 'fas fa-times'})
                                                                ),
                                                                React.createElement('div', {className: 'search-results-info-inline'},
                                                                    searchQuery ? React.createElement('span', null, `${totalFilteredItems}/${totalItems}`) : React.createElement('span', null, totalItems)
                                                                )
                                                            )
                                                        )
                                                    ),
                                                    getAllYears().map(year => 
                                                        !hiddenYears.includes(year) && React.createElement('th', {key: year}, year)
                                                    ),
                                                    comparison.from && comparison.to && React.createElement('th', null, `Perubahan (${comparison.from}  ${comparison.to})`)
                                                )
                                            ),
                                            React.createElement('tbody', null,
                                                currentItems.map(item => 
                                                    React.createElement('tr', {key: item.id, style: {cursor: 'pointer'}},
                                                        React.createElement('td', {onClick: (e) => e.stopPropagation()},
                                                            React.createElement('div', {className: 'checkbox-container'},
                                                                React.createElement('input', {
                                                                    type: 'checkbox',
                                                                    checked: selectedItems.includes(item.id),
                                                                    onChange: () => toggleItemSelection(item.id)
                                                                })
                                                            )
                                                        ),
                                                        React.createElement('td', {
                                                            className: 'item-name',
                                                            onClick: () => selectItem(item)
                                                        }, item.name),
                                                        getAllYears().map(year => 
                                                            !hiddenYears.includes(year) && React.createElement('td', {
                                                                key: year,
                                                                className: hiddenYears.includes(year) ? 'hidden-year' : '',
                                                                onClick: () => selectItem(item)
                                                            }, getPriceForYear(item, year) ? formatPrice(getPriceForYear(item, year)) : '-')
                                                        ),
                                                        comparison.from && comparison.to && React.createElement('td', {
                                                            className: getPriceChangeClass(getPriceChangeForComparison(item)),
                                                            onClick: () => selectItem(item)
                                                        }, getPriceChangeForComparison(item) ? 
                                                            `${getPriceChangeForComparison(item) > 0 ? '+' : ''}${getPriceChangeForComparison(item)}%` : 
                                                            '-'
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    ) : React.createElement('table', null,
                                        React.createElement('thead', null,
                                            React.createElement('tr', null,
                                                React.createElement('th', {style: {width: '50px'}},
                                                    React.createElement('div', {className: 'checkbox-container'},
                                                        React.createElement('input', {
                                                            type: 'checkbox',
                                                            checked: currentItems.length > 0 && currentItems.every(item => selectedItems.includes(item.id)),
                                                            onChange: toggleSelectAll
                                                        })
                                                    )
                                                ),
                                                React.createElement('th', null,
                                                    React.createElement('div', {style: {display: 'flex', flexDirection: 'column', gap: '5px'}},
                                                        React.createElement('span', null, 'Nama Barang (Part Code)'),
                                                        // Search Bar - Di dalam header kolom Nama Barang
                                                        React.createElement('div', {className: 'search-container-inline'},
                                                            React.createElement('div', {className: 'search-input-wrapper-inline'},
                                                                React.createElement('input', {
                                                                    type: 'text',
                                                                    className: 'search-input-inline',
                                                                    placeholder: 'Cari Part Code...',
                                                                    value: searchQuery,
                                                                    onChange: (e) => setSearchQuery(e.target.value)
                                                                }),
                                                                React.createElement('div', {className: 'search-icon-inline'},
                                                                    React.createElement('i', {className: 'fas fa-search'})
                                                                )
                                                            ),
                                                            searchQuery && React.createElement('button', {
                                                                className: 'search-clear-inline',
                                                                onClick: clearSearch,
                                                                title: 'Hapus pencarian'
                                                            },
                                                                React.createElement('i', {className: 'fas fa-times'})
                                                            ),
                                                            React.createElement('div', {className: 'search-results-info-inline'},
                                                                searchQuery ? React.createElement('span', null, `${totalFilteredItems}/${totalItems}`) : React.createElement('span', null, totalItems)
                                                            )
                                                        )
                                                    )
                                                ),
                                                React.createElement('th', null, 'Harga Terbaru'),
                                                React.createElement('th', null, 'Tahun Terbaru'),
                                                comparison.from && comparison.to && React.createElement('th', null, `Perubahan (${comparison.from}  ${comparison.to})`),
                                                React.createElement('th', null, 'Aksi')
                                            )
                                        ),
                                        React.createElement('tbody', null,
                                            currentItems.map(item => {
                                                const latestPrice = getLatestPrice(item.prices);
                                                const latestYear = item.prices && item.prices.length > 0 ? 
                                                    item.prices[item.prices.length - 1].year : '-';
                                                
                                                return React.createElement('tr', {
                                                    key: item.id,
                                                    style: {
                                                        cursor: 'pointer',
                                                        backgroundColor: selectedItem && selectedItem.id === item.id ? '#f0f7ff' : 'transparent'
                                                    }
                                                },
                                                    React.createElement('td', {onClick: (e) => e.stopPropagation()},
                                                        React.createElement('div', {className: 'checkbox-container'},
                                                            React.createElement('input', {
                                                                type: 'checkbox',
                                                                checked: selectedItems.includes(item.id),
                                                                onChange: () => toggleItemSelection(item.id)
                                                            })
                                                        )
                                                    ),
                                                    React.createElement('td', {
                                                        style: {color: '#000'},
                                                        onClick: () => selectItem(item)
                                                    }, item.name),
                                                    React.createElement('td', {onClick: () => selectItem(item)}, formatPrice(latestPrice)),
                                                    React.createElement('td', {onClick: () => selectItem(item)}, latestYear),
                                                    comparison.from && comparison.to && React.createElement('td', {
                                                        className: getPriceChangeClass(getPriceChangeForComparison(item)),
                                                        onClick: () => selectItem(item)
                                                    }, getPriceChangeForComparison(item) ? 
                                                        `${getPriceChangeForComparison(item) > 0 ? '+' : ''}${getPriceChangeForComparison(item)}%` : 
                                                        '-'
                                                    ),
                                                    React.createElement('td', {className: 'actions'},
                                                        React.createElement('button', {
                                                            className: 'btn-danger',
                                                            onClick: (e) => {
                                                                e.stopPropagation();
                                                                deleteItem(item.id);
                                                            }
                                                        },
                                                            React.createElement('i', {className: 'fas fa-trash'})
                                                        )
                                                    )
                                                );
                                            })
                                        )
                                    ),
                                    
                                    React.createElement('div', {style: {display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginTop: '20px'}},
                                        React.createElement('div', null,
                                            `Menampilkan ${indexOfFirstItem + 1}-${Math.min(indexOfLastItem, filteredItems.length)} dari ${filteredItems.length} barang`,
                                            selectedItems.length > 0 && ` | ${selectedItems.length} item dipilih`,
                                            searchQuery && ` (pencarian: "${searchQuery}")`
                                        ),
                                        React.createElement('div', {className: 'pagination'},
                                            React.createElement('button', {
                                                onClick: () => setCurrentPage(prev => Math.max(prev - 1, 1)),
                                                disabled: currentPage === 1
                                            },
                                                React.createElement('i', {className: 'fas fa-chevron-left'})
                                            ),
                                            
                                            Array.from({ length: Math.min(5, totalPages) }, (_, i) => {
                                                const pageNum = i + 1;
                                                return React.createElement('button', {
                                                    key: pageNum,
                                                    className: currentPage === pageNum ? 'active' : '',
                                                    onClick: () => setCurrentPage(pageNum)
                                                }, pageNum);
                                            }),
                                            
                                            totalPages > 5 && React.createElement('span', {style: {padding: '8px 12px'}}, '...'),
                                            
                                            React.createElement('button', {
                                                onClick: () => setCurrentPage(prev => Math.min(prev + 1, totalPages)),
                                                disabled: currentPage === totalPages
                                            },
                                                React.createElement('i', {className: 'fas fa-chevron-right'})
                                            )
                                        )
                                    )
                                )
                            ) : React.createElement('div', {className: 'folder-empty-state'},
                                React.createElement('i', {className: 'fas fa-folder-open'}),
                                React.createElement('h3', null, `Folder "${folders.find(f => f.id === activeFolder)?.name}" Kosong`),
                                React.createElement('p', null, 'Import file Excel untuk mulai menambahkan data barang ke folder ini'),
                                React.createElement('div', {style: {marginTop: '30px'}},
                                    React.createElement('div', {className: 'import-controls-compact'},
                                        React.createElement('select', {
                                            className: 'compact-folder-select',
                                            value: selectedFolderForImport,
                                            onChange: (e) => setSelectedFolderForImport(e.target.value)
                                        },
                                            folders.map(folder => 
                                                React.createElement('option', {key: folder.id, value: folder.id}, folder.name)
                                            )
                                        ),
                                        React.createElement('div', {className: 'file-input-improved'},
                                            React.createElement('button', {className: 'btn', style: {padding: '15px 30px', fontSize: '16px'}},
                                                React.createElement('i', {className: 'fas fa-file-import'}),
                                                ' Import Data Excel'
                                            ),
                                            React.createElement('input', {
                                                type: 'file',
                                                accept: '.xlsx, .xls',
                                                onChange: handleFileImport
                                            })
                                        )
                                    )
                                )
                            )
                        ) : React.createElement('div', {className: 'folder-empty-state'},
                            React.createElement('i', {className: 'fas fa-folder'}),
                            React.createElement('h3', null, 'Belum Ada Folder'),
                            React.createElement('p', null, 'Buat folder baru untuk mulai mengelola data harga barang'),
                            React.createElement('button', {
                                className: 'btn',
                                style: {padding: '15px 30px', fontSize: '16px', marginTop: '20px'},
                                onClick: () => setShowFolderModal(true)
                            },
                                React.createElement('i', {className: 'fas fa-plus'}),
                                ' Buat Folder Baru'
                            )
                        )
                    )
                ),

                // Modal untuk membuat folder baru
                showFolderModal && React.createElement('div', {className: 'folder-modal'},
                    React.createElement('div', {className: 'folder-modal-content'},
                        React.createElement('div', {className: 'folder-modal-header'},
                            React.createElement('div', {className: 'folder-modal-title'},
                                React.createElement('i', {className: 'fas fa-folder-plus'}),
                                ' Buat Folder Baru'
                            ),
                            React.createElement('button', {
                                className: 'folder-modal-close',
                                onClick: () => setShowFolderModal(false)
                            },
                                React.createElement('i', {className: 'fas fa-times'})
                            )
                        ),
                        
                        React.createElement('div', {className: 'folder-form-group'},
                            React.createElement('label', {className: 'folder-form-label'}, 'Nama Folder'),
                            React.createElement('input', {
                                type: 'text',
                                className: 'folder-form-input',
                                value: newFolderName,
                                onChange: (e) => setNewFolderName(e.target.value),
                                placeholder: 'Masukkan nama folder (contoh: VESDA, SIMPLEX, dll.)',
                                autoFocus: true
                            })
                        ),
                        
                        React.createElement('div', {className: 'folder-form-actions'},
                            React.createElement('button', {
                                className: 'btn btn-secondary',
                                onClick: () => setShowFolderModal(false)
                            }, 'Batal'),
                            React.createElement('button', {
                                className: 'btn btn-success',
                                onClick: createNewFolder
                            },
                                React.createElement('i', {className: 'fas fa-plus'}),
                                ' Buat Folder'
                            )
                        )
                    )
                )
            );
        };

        // Komponen utama aplikasi
        const App = () => {
            const [user, setUser] = useState(null);
            const [isLoading, setIsLoading] = useState(true);

            // Cek apakah user sudah login
            useEffect(() => {
                const unsubscribe = auth.onAuthStateChanged((user) => {
                    if (user) {
                        setUser(user);
                        showNotification('success', 'Login Berhasil', `Selamat datang, ${user.email}!`);
                    } else {
                        setUser(null);
                    }
                    setIsLoading(false);
                });

                return () => unsubscribe();
            }, []);

            const handleLoginSuccess = (user) => {
                setUser(user);
            };

            if (isLoading) {
                return React.createElement('div', {className: 'login-container'},
                    React.createElement('div', {className: 'login-card', style: {textAlign: 'center'}},
                        React.createElement('div', {className: 'login-loading', style: {width: '50px', height: '50px', margin: '30px auto'}}),
                        React.createElement('p', {style: {color: '#7f8c8d', marginTop: '20px'}}, 'Memuat aplikasi...')
                    )
                );
            }

            if (!user) {
                return React.createElement(LoginPage, { onLoginSuccess: handleLoginSuccess });
            }

            return React.createElement(MainApp, { user: user });
        };

        ReactDOM.render(React.createElement(App), document.getElementById('root'));
    </script>
</body>
</html>
